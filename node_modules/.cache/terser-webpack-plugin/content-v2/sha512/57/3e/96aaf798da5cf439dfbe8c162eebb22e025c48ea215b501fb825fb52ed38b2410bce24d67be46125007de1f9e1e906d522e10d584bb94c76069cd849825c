{"code":"!function(t){var e={};function o(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var s in t)o.d(n,s,function(e){return t[e]}.bind(null,s));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,\"a\",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p=\"\",o(o.s=13)}([function(t,e,o){\"use strict\";o.d(e,\"c\",(function(){return r})),o.d(e,\"e\",(function(){return c})),o.d(e,\"d\",(function(){return l})),o.d(e,\"b\",(function(){return u})),o.d(e,\"f\",(function(){return p})),o.d(e,\"g\",(function(){return d}));var n=o(6),s=o.n(n),i=o(5);let a=!1;const r=({page:t,params:e=null})=>{a||(a=!0,my.navigateTo({url:\"\"+s.a.stringifyUrl({url:`pages/${t}/index`,query:e})}),setTimeout(()=>{a=!1},200))},c=t=>s.a.parse(t,{parseBooleans:!0}),l=async t=>{const e=\"Android\"===(await Object(i.a)()).system,o=\"tikivn://open-webpage\";if(t.startsWith(\"https://\")||t.startsWith(\"http://\")){const n=e?\"tikivn://webview\":o;return my.openDeeplink({url:`${n}?url=${t}`})}return t.startsWith(o)&&e?my.openDeeplink({url:t.replace(o,\"tikivn://webview\")}):t.startsWith(\"tikivn://webview\")&&!e?my.openDeeplink({url:t.replace(\"tikivn://webview\",o)}):my.openDeeplink({url:t})},u=({product:t,page:e})=>{l(`tikivn://products/${t.id}?spid=${t.seller_product_id}&itm_source=tiniapp&itm_medium=CPC&itm_campaign=TNA_NPD_TKS_APP_APP_APP_UNK_TNA_UNK_UNK_LD01_CPC_UNK_UNK_Z.vn.tiki.tini.brand_CN.pages/${e}/index`)},p=(t=\"\")=>{my.addIconsToNavigationBar({icons:[{image:t||\"/assets/icons/cart.png\",width:24,height:24}],padding:8})},d=(t=\"\")=>{my.addIconsToNavigationBar({icons:[{image:t||\"/assets/icons/tab-search.png\",width:24,height:24}],padding:8})}},function(t,e,o){\"use strict\";o.d(e,\"c\",(function(){return m})),o.d(e,\"d\",(function(){return f})),o.d(e,\"a\",(function(){return y})),o.d(e,\"b\",(function(){return v}));var n=o(5);let s=null;const i=async()=>{if(!s){const{app:t}=await Object(n.a)();s=\"Tiki\"===t?\"prod\":\"dev\"}return{dev:\"https://api.tala.xyz/tiniapp-open-api\",prod:\"https://api.tiki.vn/tiniapp-open-api\"}[s]};var a=o(3),r=o(6),c=o.n(r);const l=getApp().brandName;let u=null,p=null;const d=async()=>{try{return u||(u=await(async()=>new Promise((t,e)=>{my.request({url:\"\"+c.a.stringifyUrl({url:\"https://tiki.vn/api/v2/brands\",query:{slug:l}}),headers:{\"Content-Type\":\"application/json\",\"User-Agent\":a.b},success:e=>{t(e.data[0])},fail:t=>{e(t)}})}))(),u)}catch{}},g=async()=>(p||(p=d()),p);var h=async({path:t=\"\",method:e=\"GET\",headers:o={},params:n=null,baseUrl:s,data:r})=>{const[l,u]=await Promise.all([i(),g()]);return new Promise((i,p)=>{my.request({url:\"\"+c.a.stringifyUrl({url:`${s||l}${t}`,query:{...n,brand:u.query_value}},{skipNull:!0}),headers:{\"Content-Type\":\"application/json\",\"User-Agent\":a.b,...o},method:e,data:r,success:t=>{i(t)},fail:t=>{p(t)}})})};const m=async({page:t=1,limit:e=10,sort:o,filter:n,search:s,...i})=>await h({baseUrl:\"https://tiki.vn/api/v2\",path:\"/products\",params:{aggregations:2,page:t,limit:e,sort:o,q:s,...n,...i}}),f=()=>o(24),y=()=>o(25),v=()=>({data:o(28),paging:{current_page:1,last_page:1}})},function(t,e,o){\"use strict\";o.d(e,\"c\",(function(){return s})),o.d(e,\"e\",(function(){return i})),o.d(e,\"f\",(function(){return a})),o.d(e,\"a\",(function(){return r})),o.d(e,\"d\",(function(){return c})),o.d(e,\"b\",(function(){return l}));const n=t=>(t=>null!=t)(t)&&(t+\"\").trim().length>0,s=(t,e=8)=>t&&t.length?t.reduce((o,n,s)=>(s%e==0&&o.push(t.slice(s,s+e)),o),[]):[],i=(t,e=\" ₫\")=>n(t)?parseInt(t).toLocaleString(\"vi-VN\")+e:\"\",a=t=>n(t)?+[...t.toString()].filter(t=>t<=\"9\"&&t>=\"0\").join(\"\"):\"\",r=t=>JSON.parse(JSON.stringify(t)),c=(t,e)=>JSON.stringify(t)===JSON.stringify(e),l=t=>new Promise(e=>{setTimeout(()=>{e()},t)})},function(t,e,o){\"use strict\";o.d(e,\"b\",(function(){return n})),o.d(e,\"a\",(function(){return s})),o.d(e,\"c\",(function(){return i}));const n=\"vn.tiki.tini.brand\",s={UPDATE_FILTERS:\"UPDATE_FILTERS\"},i=[{label:\"Phổ biến\",value:\"default\"},{label:\"Bán chạy\",value:\"top_seller\"},{label:\"Mới nhất\",value:\"newest\"},{label:\"Giá thấp đến cao\",value:\"price,asc\"},{label:\"Giá cao đến thấp\",value:\"price,desc\"}]},function(t,e,o){\"use strict\";o.d(e,\"b\",(function(){return r})),o.d(e,\"c\",(function(){return c})),o.d(e,\"a\",(function(){return a}));var n=class{constructor(){this.events={}}_getEventListByName(t){return void 0===this.events[t]&&(this.events[t]=new Set),this.events[t]}on(t,e){return this._getEventListByName(t).add(e),()=>this.removeListener(t,e)}once(t,e){const o=this,n=function(...s){o.removeListener(t,n),e.apply(o,s)};this.on(t,n)}emit(t,...e){this._getEventListByName(t).forEach(function(t){t.apply(this,e)}.bind(this))}removeListener(t,e){this._getEventListByName(t).delete(e)}},s=o(3);const i=new n;let a={};const r=t=>Object.entries(t).reduce((t,[e,o])=>{if(!e||!o)return t;if(\"service\"===e){const e=o.filter(t=>t.checked).reduce((t,e)=>({...t,[e.query_name]:\"freeship_campaign\"===e.query_name?\"freeship_plus\":1}),{});return{...t,...e}}return\"priceRange\"===e?o.start&&o.end?{...t,price:`${o.start.value},${o.end.value}`}:t:{...t,[e]:o.query_value}},{}),c=t=>{var e;a=(t=>{const e=t.filter(t=>[\"category\",\"stock_location\",\"price\"].includes(t.query_name)).reduce((t,e)=>(t[e.query_name]=e.values,t),{});return e.service=[{query_name:\"support_p2h_delivery\",thumbnail_url:\"/assets/images/filter-tikinow.png\",display_value:\"TIKINOW\",description:\"Giao siêu tốc 2h\",checked:!1},{query_name:\"freeship_campaign\",thumbnail_url:\"/assets/images/filter-freeship.png\",display_value:\"FREESHIP\",description:\"Không giới hạn\",checked:!1},{query_name:\"is_best_price_guaranteed\",display_value:\"Rẻ Hơn Hoàn Tiền\",checked:!1}],e})(t),e=t,i.emit(s.a.UPDATE_FILTERS,e)}},function(t,e,o){\"use strict\";o.d(e,\"a\",(function(){return c})),o.d(e,\"b\",(function(){return a}));const n=new class{constructor(){this.data=[],this.config={debugJSAPI:!0}}addLogItem(t){this.data.unshift(t)}debug(...t){this.addLogItem({type:\"log\",createdAt:(new Date).getTime(),params:{input:t.join(\" \"),result:\"ok\",latency:0}})}clearLog(){this.data=[]}promisify(t,e){return(...o)=>new Promise((n,s)=>{let i,a;this.config.debugJSAPI&&(a=(new Date).getTime(),i={type:\"myx.\"+e,createdAt:a,params:{input:o}},this.addLogItem(i)),t({...o[0],success:t=>{this.config.debugJSAPI&&(i.params.result=t),n(t)},fail:t=>{this.config.debugJSAPI&&(i.params.error=t),s(t)},complete:()=>{this.config.debugJSAPI&&(i.params.latency=(new Date).getTime()-a)}})})}},s={get:function(t,e,o){return t[e]?t[e]:my[e]?t.promisify(my[e],e):void console.warn(`API myx.${e} does not exist.`)}};var i=new Proxy(n,s);let a=null,r=null;const c=async()=>(r||(r=(async()=>a||(a=await i.getSystemInfo([\"app\",\"windowHeight\"]),a))()),r)},function(t,e,o){const n=o(20),s=o(21),i=o(22),a=o(23),r=Symbol(\"encodeFragmentIdentifier\");function c(t){if(\"string\"!=typeof t||1!==t.length)throw new TypeError(\"arrayFormatSeparator must be single character string\")}function l(t,e){return e.encode?e.strict?n(t):encodeURIComponent(t):t}function u(t,e){return e.decode?s(t):t}function p(t){const e=t.indexOf(\"#\");return-1!==e&&(t=t.slice(0,e)),t}function d(t){const e=(t=p(t)).indexOf(\"?\");return-1===e?\"\":t.slice(e+1)}function g(t,e){return e.parseNumbers&&!Number.isNaN(Number(t))&&\"string\"==typeof t&&\"\"!==t.trim()?t=Number(t):!e.parseBooleans||null===t||\"true\"!==t.toLowerCase()&&\"false\"!==t.toLowerCase()||(t=\"true\"===t.toLowerCase()),t}function h(t,e){c((e=Object.assign({decode:!0,sort:!0,arrayFormat:\"none\",arrayFormatSeparator:\",\",parseNumbers:!1,parseBooleans:!1},e)).arrayFormatSeparator);const o=function(t){let e;switch(t.arrayFormat){case\"index\":return(t,o,n)=>{e=/\\[(\\d*)\\]$/.exec(t),t=t.replace(/\\[\\d*\\]$/,\"\"),e?(void 0===n[t]&&(n[t]={}),n[t][e[1]]=o):n[t]=o};case\"bracket\":return(t,o,n)=>{e=/(\\[\\])$/.exec(t),t=t.replace(/\\[\\]$/,\"\"),e?void 0!==n[t]?n[t]=[].concat(n[t],o):n[t]=[o]:n[t]=o};case\"comma\":case\"separator\":return(e,o,n)=>{const s=\"string\"==typeof o&&o.includes(t.arrayFormatSeparator),i=\"string\"==typeof o&&!s&&u(o,t).includes(t.arrayFormatSeparator);o=i?u(o,t):o;const a=s||i?o.split(t.arrayFormatSeparator).map(e=>u(e,t)):null===o?o:u(o,t);n[e]=a};case\"bracket-separator\":return(e,o,n)=>{const s=/(\\[\\])$/.test(e);if(e=e.replace(/\\[\\]$/,\"\"),!s)return void(n[e]=o?u(o,t):o);const i=null===o?[]:o.split(t.arrayFormatSeparator).map(e=>u(e,t));void 0!==n[e]?n[e]=[].concat(n[e],i):n[e]=i};default:return(t,e,o)=>{void 0!==o[t]?o[t]=[].concat(o[t],e):o[t]=e}}}(e),n=Object.create(null);if(\"string\"!=typeof t)return n;if(!(t=t.trim().replace(/^[?#&]/,\"\")))return n;for(const s of t.split(\"&\")){if(\"\"===s)continue;let[t,a]=i(e.decode?s.replace(/\\+/g,\" \"):s,\"=\");a=void 0===a?null:[\"comma\",\"separator\",\"bracket-separator\"].includes(e.arrayFormat)?a:u(a,e),o(u(t,e),a,n)}for(const t of Object.keys(n)){const o=n[t];if(\"object\"==typeof o&&null!==o)for(const t of Object.keys(o))o[t]=g(o[t],e);else n[t]=g(o,e)}return!1===e.sort?n:(!0===e.sort?Object.keys(n).sort():Object.keys(n).sort(e.sort)).reduce((t,e)=>{const o=n[e];return Boolean(o)&&\"object\"==typeof o&&!Array.isArray(o)?t[e]=function t(e){return Array.isArray(e)?e.sort():\"object\"==typeof e?t(Object.keys(e)).sort((t,e)=>Number(t)-Number(e)).map(t=>e[t]):e}(o):t[e]=o,t},Object.create(null))}e.extract=d,e.parse=h,e.stringify=(t,e)=>{if(!t)return\"\";c((e=Object.assign({encode:!0,strict:!0,arrayFormat:\"none\",arrayFormatSeparator:\",\"},e)).arrayFormatSeparator);const o=o=>e.skipNull&&null==t[o]||e.skipEmptyString&&\"\"===t[o],n=function(t){switch(t.arrayFormat){case\"index\":return e=>(o,n)=>{const s=o.length;return void 0===n||t.skipNull&&null===n||t.skipEmptyString&&\"\"===n?o:null===n?[...o,[l(e,t),\"[\",s,\"]\"].join(\"\")]:[...o,[l(e,t),\"[\",l(s,t),\"]=\",l(n,t)].join(\"\")]};case\"bracket\":return e=>(o,n)=>void 0===n||t.skipNull&&null===n||t.skipEmptyString&&\"\"===n?o:null===n?[...o,[l(e,t),\"[]\"].join(\"\")]:[...o,[l(e,t),\"[]=\",l(n,t)].join(\"\")];case\"comma\":case\"separator\":case\"bracket-separator\":{const e=\"bracket-separator\"===t.arrayFormat?\"[]=\":\"=\";return o=>(n,s)=>void 0===s||t.skipNull&&null===s||t.skipEmptyString&&\"\"===s?n:(s=null===s?\"\":s,0===n.length?[[l(o,t),e,l(s,t)].join(\"\")]:[[n,l(s,t)].join(t.arrayFormatSeparator)])}default:return e=>(o,n)=>void 0===n||t.skipNull&&null===n||t.skipEmptyString&&\"\"===n?o:null===n?[...o,l(e,t)]:[...o,[l(e,t),\"=\",l(n,t)].join(\"\")]}}(e),s={};for(const e of Object.keys(t))o(e)||(s[e]=t[e]);const i=Object.keys(s);return!1!==e.sort&&i.sort(e.sort),i.map(o=>{const s=t[o];return void 0===s?\"\":null===s?l(o,e):Array.isArray(s)?0===s.length&&\"bracket-separator\"===e.arrayFormat?l(o,e)+\"[]\":s.reduce(n(o),[]).join(\"&\"):l(o,e)+\"=\"+l(s,e)}).filter(t=>t.length>0).join(\"&\")},e.parseUrl=(t,e)=>{e=Object.assign({decode:!0},e);const[o,n]=i(t,\"#\");return Object.assign({url:o.split(\"?\")[0]||\"\",query:h(d(t),e)},e&&e.parseFragmentIdentifier&&n?{fragmentIdentifier:u(n,e)}:{})},e.stringifyUrl=(t,o)=>{o=Object.assign({encode:!0,strict:!0,[r]:!0},o);const n=p(t.url).split(\"?\")[0]||\"\",s=e.extract(t.url),i=e.parse(s,{sort:!1}),a=Object.assign(i,t.query);let c=e.stringify(a,o);c&&(c=\"?\"+c);let u=function(t){let e=\"\";const o=t.indexOf(\"#\");return-1!==o&&(e=t.slice(o)),e}(t.url);return t.fragmentIdentifier&&(u=\"#\"+(o[r]?l(t.fragmentIdentifier,o):t.fragmentIdentifier)),`${n}${c}${u}`},e.pick=(t,o,n)=>{n=Object.assign({parseFragmentIdentifier:!0,[r]:!1},n);const{url:s,query:i,fragmentIdentifier:c}=e.parseUrl(t,n);return e.stringifyUrl({url:s,query:a(i,o),fragmentIdentifier:c},n)},e.exclude=(t,o,n)=>{const s=Array.isArray(o)?t=>!o.includes(t):(t,e)=>!o(t,e);return e.pick(t,s,n)}},function(t,e,o){\"use strict\";o.d(e,\"a\",(function(){return n}));function n(t,e){void 0===e&&(e={});var o={};for(var n in t)/data-/gi.test(n)&&(o[n.replace(/data-/gi,\"\")]=t[n]);return Object.assign({},e,{currentTarget:{dataset:o},target:{dataset:o,targetDataset:o}})}},function(t,e){function o(){return t.exports=o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t},t.exports.default=t.exports,t.exports.__esModule=!0,o.apply(this,arguments)}t.exports=o,t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&(\"object\"==e||\"function\"==e)}},function(t,e,o){var n=o(52)||Function(\"return this\")();t.exports=n},function(t,e,o){var n=o(10).Symbol;t.exports=n},function(t,e,o){var n=o(9),s=o(51),i=o(53),a=Math.max,r=Math.min;t.exports=function(t,e,o){var c,l,u,p,d,g,h=0,m=!1,f=!1,y=!0;if(\"function\"!=typeof t)throw new TypeError(\"Expected a function\");function v(e){var o=c,n=l;return c=l=void 0,h=e,p=t.apply(n,o)}function b(t){return h=t,d=setTimeout(_,e),m?v(t):p}function C(t){var o=t-g;return void 0===g||o>=e||o<0||f&&t-h>=u}function _(){var t=s();if(C(t))return k(t);d=setTimeout(_,function(t){var o=e-(t-g);return f?r(o,u-(t-h)):o}(t))}function k(t){return d=void 0,y&&c?v(t):(c=l=void 0,p)}function x(){var t=s(),o=C(t);if(c=arguments,l=this,g=t,o){if(void 0===d)return b(g);if(f)return clearTimeout(d),d=setTimeout(_,e),v(g)}return void 0===d&&(d=setTimeout(_,e)),p}return e=i(e)||0,n(o)&&(m=!!o.leading,u=(f=\"maxWait\"in o)?a(i(o.maxWait)||0,e):u,y=\"trailing\"in o?!!o.trailing:y),x.cancel=function(){void 0!==d&&clearTimeout(d),h=0,c=g=l=d=void 0},x.flush=function(){return void 0===d?p:k(s())},x}},function(t,e,o){t.exports=o(14)},function(t,e,o){(function(t){if(t.__TF_MINIAPP_COMPILER_VERSION__=\"1.96.9\",self!==t&&(self=t),!self.__tfAppInited){if(self.__tfAppInited=1,!self.TFApp){var e=location.search.match(/tfp=([^&#]+)/);if(e&&e[1]){var n=decodeURIComponent(e[1]);n&&importScripts(n+\"/tf-tiniapp.worker.js\")}else{var s=location.search.match(/__enableCache=([^&#]+)/);if(s&&\"YES\"===s[1]){var i=\"\";location.hash&&location.hash.match(/NOCACHE/)&&(i=\"#NOCACHE\"),importScripts(\"miniapp-resource://framework/tf-tiniapp.worker.js\"+i)}}}(void 0!==t?t:self).tfAppJson={$homepage:\"pages/feed/index\"};const a=self.TFApp.getAppContext?self.TFApp.getAppContext().TFApp:self.TFApp;self.App=a.App,self.getApp=a.getApp,self.Page=a.Page,self.Component=a.Component,self.$global=a.$global,self.my=a.bridge,self.getCurrentPages=a.getCurrentPages,a.registerApp&&a.registerApp({appJSON:tfAppJson}),self.TFApp.bootstrapApp({success:function(){o(16),o(17),o(18),o(19),o(29),o(30),o(31),o(32),o(33),o(34),o(35),o(65),o(36),o(37),o(38),o(39),o(40),o(41),o(42),o(43),o(66),o(44),o(45),o(46),o(47),o(48),o(49),o(50),o(67),o(61),o(62),o(63),o(64)}})}}).call(this,o(15))},function(t,e){var o;o=function(){return this}();try{o=o||new Function(\"return this\")()}catch(t){\"object\"==typeof window&&(o=window)}t.exports=o},function(t,e,o){\"use strict\";o.r(e);var n=o(5);App({brandName:\"BIZBOOKS\",brandLogo:\"https://salt.tikicdn.com/ts/miniapp/f5/19/83/44d96fa4c4bb3737675cc1d7066fe825.png\",brandCover:\"https://salt.tikicdn.com/ts/miniapp/e7/c7/7a/bea940e9b1037e9531bef9c210de617c.png\",onLaunch(){Object(n.a)()}})},function(t,e,o){\"use strict\";o.r(e);o(2);$global.currentComponentConfig={is:\"components/post/index\",componentLifeCycleV2:!0},Component({mixins:[],data:{x:1},props:{post:{id:\"\",userName:\"Trường Nguyễn\",userAvatar:\"/assets/images/ava.png\",bookName:\"Dark Nhân Tâm\",action:\"reviewed\",bookCover:\"\",image:\"/assets/images/dark-nhan-tam.png\",content:\"Cuốn sách này đã cho mình nhiều bài học trong cuộc sống. Đặc biệt cuốn sách này tạo động lực cho mình về các kế hoạch tương lai. Mình cảm ơn giả đã tạo ra một cuốn sách ý nghĩa này.\",postedTime:\"16:30 July 7, 2022\",likes:1251,comments:1032,shares:51,isLiked:!1}},didMount(){},didUpdate(){},didUnmount(){},methods:{handleTap(){}}})},function(t,e,o){\"use strict\";o.r(e);o(2);$global.currentComponentConfig={is:\"components/comment/index\",componentLifeCycleV2:!0},Component({mixins:[],data:{x:1},props:{comment:{id:\"\",userName:\"Trường Nguyễn\",userAvatar:\"/assets/images/ava.png\",content:\"Sách này cũng không hay lắm đâu\",postedTime:\"16:30 July 7, 2022\",likes:1251}},didMount(){},didUpdate(){},didUnmount(){},methods:{handleTap(){}}})},function(t,e,o){\"use strict\";o.r(e);var n=o(0),s=o(1),i=o(5),a=o(3),r=o(4);o(2);$global.currentPageConfig={pagePath:\"pages/feed/index\",usingComponents:{post:\"components/post/index\",comment:\"components/comment/index\"}},Page({hasMore:!1,actionButtons:0,data:{showActions:!1,showCategory:!1,isLoadingPost:!0,isLoadingMorePost:!1,Posts:{data:[],paging:{current_page:0,last_page:0}},isStickButtons:!1,isScrollUp:!1},async loadData(){this.setData({isLoadingPost:!0,isLoadingCategories:!0});try{const[t]=await Promise.all([Object(s.b)()]);console.log(t.data),this.hasMore=t.paging.current_page<t.paging.last_page,this.setData({Posts:t,isLoadingPost:!1,isLoadingCategories:!1})}catch{this.setData({isLoadingPost:!1,isLoadingCategories:!1})}},async loadPosts(){this.setData({isLoadingPost:!0});try{const t=await Object(s.b)({page:1,limit:10,sort:this.data.selectedSort.value,category:this.data.selectedCategory,filter:Object(r.b)(this.data.selectedFilters)});this.hasMore=t.paging.current_page<t.paging.last_page,this.setData({Posts:t,isLoadingPost:!1})}catch{this.setData({isLoadingPost:!1})}},async loadMorePosts(){const{Posts:t,isLoadingPost:e,isLoadingMorePost:o}=this.data;if(!this.hasMore||e||o)return;this.setData({isLoadingMorePost:!0});const{data:n,paging:i}=t;try{const{data:t,paging:e}=await Object(s.b)({page:i.current_page+1,limit:10,sort:this.data.selectedSort.value,category:this.data.selectedCategory,filter:Object(r.b)(this.data.selectedFilters)});this.hasMore=e.current_page<e.last_page,this.setData({Posts:{data:[...n,...t],paging:e},isLoadingMorePost:!1})}catch{this.setData({isLoadingMorePost:!1})}},onSelectFilter(t){this.setData({selectedFilters:t}),this.loadPosts()},onSelectSort(t){this.setData({selectedSort:t}),this.loadPosts()},removeFilter(t){const e={...this.data};if(\"priceRange\"===t.key)return e.selectedFilters[t.key]={start:null,end:null},this.setData(e),void this.loadPosts();const o=e.selectedFilters.service&&e.selectedFilters.service.findIndex(e=>e.query_name===t.key);if(\"number\"==typeof o&&-1!==o)return e.selectedFilters.service[o].checked=!1,this.setData(e),void this.loadPosts();e.selectedFilters[t.key]=null,this.setData(e),this.loadPosts()},onTapPost(t){Object(n.goToPostDetail)({Post:t,page:\"Post\"})},goToCategoryDetail(t){Object(n.c)({page:\"Post\",params:{title:t.display_value,category:t.query_value,showCategory:!1}})},onCustomIconEvent(){Object(n.d)(\"tikivn://cart\")},onLoad(t){const{title:e,sort:o,category:s,showCategory:i=!0,showActions:r=!0}=Object(n.e)(t),c={...this.data};if(o){const t=a.c.find(t=>t.value===o);t&&(c.selectedSort=t)}s&&(c.selectedCategory=s),this.setData({...c,showCategory:i,showActions:r}),my.setNavigationBar({title:\"New Feed\"}),Object(n.g)()},onPageScroll(t){const{isStickButtons:e,isScrollUp:o}=this.data,{scrollHeight:n,scrollTop:s}=t;s>=this.actionButtons+40&&!e&&this.setData({isStickButtons:!0}),s<this.actionButtons+40&&e&&this.setData({isStickButtons:!1}),s<this.prevScrollTop&&!o&&this.setData({isScrollUp:!0}),s>this.prevScrollTop&&o&&this.setData({isScrollUp:!1}),this.prevScrollTop=s,i.b.windowHeight+s>=n-1e3&&this.loadMorePosts()},onReady(){this.loadData(),this.setData({filters:r.a}),my.createSelectorQuery().select(\".Post-action-buttons\").boundingClientRect().exec(([t])=>{this.actionButtons=t&&t.top?t.top:0})}})},function(t,e){t.exports=t=>encodeURIComponent(t).replace(/[!'()*]/g,t=>\"%\"+t.charCodeAt(0).toString(16).toUpperCase())},function(t,e){var o=new RegExp(\"%[a-f0-9]{2}\",\"gi\"),n=new RegExp(\"(%[a-f0-9]{2})+\",\"gi\");function s(t,e){try{return decodeURIComponent(t.join(\"\"))}catch(t){}if(1===t.length)return t;e=e||1;var o=t.slice(0,e),n=t.slice(e);return Array.prototype.concat.call([],s(o),s(n))}function i(t){try{return decodeURIComponent(t)}catch(i){for(var e=t.match(o),n=1;n<e.length;n++)e=(t=s(e,n).join(\"\")).match(o);return t}}t.exports=function(t){if(\"string\"!=typeof t)throw new TypeError(\"Expected `encodedURI` to be of type `string`, got `\"+typeof t+\"`\");try{return t=t.replace(/\\+/g,\" \"),decodeURIComponent(t)}catch(e){return function(t){for(var e={\"%FE%FF\":\"��\",\"%FF%FE\":\"��\"},o=n.exec(t);o;){try{e[o[0]]=decodeURIComponent(o[0])}catch(t){var s=i(o[0]);s!==o[0]&&(e[o[0]]=s)}o=n.exec(t)}e[\"%C2\"]=\"�\";for(var a=Object.keys(e),r=0;r<a.length;r++){var c=a[r];t=t.replace(new RegExp(c,\"g\"),e[c])}return t}(t)}}},function(t,e){t.exports=(t,e)=>{if(\"string\"!=typeof t||\"string\"!=typeof e)throw new TypeError(\"Expected the arguments to be of type `string`\");if(\"\"===e)return[t];const o=t.indexOf(e);return-1===o?[t]:[t.slice(0,o),t.slice(o+e.length)]}},function(t,e){t.exports=function(t,e){for(var o={},n=Object.keys(t),s=Array.isArray(e),i=0;i<n.length;i++){var a=n[i],r=t[a];(s?-1!==e.indexOf(a):e(a,r,t))&&(o[a]=r)}return o}},function(t){t.exports=JSON.parse('{\"name\":\"Địt mẹ cuộc đời\",\"avt\":\"/assets/images/empty.png\",\"coupons\":69,\"points\":420}')},function(t){t.exports=JSON.parse('{\"waiting\":0,\"processing\":0,\"shipping\":0}')},function(t){t.exports=JSON.parse('{\"user\":{\"name\":\"User name\",\"avt\":\"/assets/images/logo.png\",\"joinDate\":\"20/04/2020\"},\"point\":420,\"barcode\":\"42069-69420-42069\"}')},function(t){t.exports=JSON.parse('[{\"id\":\"1\",\"code\":\"demo1\"},{\"id\":\"2\",\"code\":\"demo2\"}]')},function(t){t.exports=JSON.parse('[{\"id\":\"1\",\"userName\":\"Đình Trường\",\"userAvatar\":\"/assets/images/ava_truong.jpg\",\"bookName\":\"Dark Nhân Tâm\",\"action\":\"reviewed\",\"bookCover\":\"\",\"image\":\"/assets/images/dark-nhan-tam.png\",\"content\":\"Cuốn sách này đã cho mình nhiều bài học trong cuộc sống. Đặc biệt cuốn sách này tạo động lực cho mình về các kế hoạch tương lai. Mình cảm ơn giả đã tạo ra một cuốn sách ý nghĩa này.\",\"postedTime\":\"16:30 July 7, 2022\",\"likes\":1251,\"comments\":1032,\"shares\":51,\"isLiked\":false},{\"id\":\"2\",\"userName\":\"Khang Nguyễn\",\"userAvatar\":\"/assets/images/ava_khang.jpg\",\"bookName\":\"Dark Nhân Tâm\",\"action\":\"reviewed\",\"bookCover\":\"\",\"image\":\"/assets/images/dark-nhan-tam.png\",\"content\":\"Cuốn sách này đã cho mình nhiều bài học trong cuộc sống. Đặc biệt cuốn sách này tạo động lực cho mình về các kế hoạch tương lai. Mình cảm ơn giả đã tạo ra một cuốn sách ý nghĩa này.\",\"postedTime\":\"16:30 July 7, 2022\",\"likes\":1251,\"comments\":1032,\"shares\":51,\"isLiked\":false},{\"id\":\"3\",\"userName\":\"Hoàng Dương\",\"userAvatar\":\"/assets/images/ava_hoang.jpg\",\"bookName\":\"Dark Nhân Tâm\",\"action\":\"published\",\"bookCover\":\"\",\"image\":\"/assets/images/dark-nhan-tam.png\",\"content\":\"Cuốn sách này đã cho mình nhiều bài học trong cuộc sống. Đặc biệt cuốn sách này tạo động lực cho mình về các kế hoạch tương lai. Mình cảm ơn giả đã tạo ra một cuốn sách ý nghĩa này.\",\"postedTime\":\"16:30 July 7, 2022\",\"likes\":1251,\"comments\":1032,\"shares\":51,\"isLiked\":false}]')},function(t,e){$global.currentComponentConfig={is:\"components/banners/index\",componentLifeCycleV2:!0},Component({props:{className:\"\",isLoading:!0,banners:[],onTapBanner:()=>{}},methods:{_onTapBanner(t){const{item:e}=t.target.dataset;this.props.onTapBanner(e)}}})},function(t,e){$global.currentComponentConfig={is:\"components/section-title/index\",componentLifeCycleV2:!0},Component({props:{title:\"\",action:\"\",sort:\"\",onTapActionButton:()=>{}},methods:{_onTapActionButton(){this.props.onTapActionButton({title:this.props.title,sort:this.props.sort})}}})},function(t,e){$global.currentComponentConfig={is:\"components/product/index\",componentLifeCycleV2:!0},Component({props:{className:\"\",isLoading:!1,product:{id:\"\",name:\"\",thumbnail_url:\"\",price:0,list_price:0,discount_rate:0},onTapProduct:()=>{}},methods:{_onTapProduct(){this.props.onTapProduct(this.props.product)}}})},function(t,e){$global.currentComponentConfig={is:\"components/product-section/index\",componentLifeCycleV2:!0,usingComponents:{product:\"components/product/index\"}},Component({props:{isLoading:!1,type:\"vertical\",skeletons:4,className:\"\",products:[],onTapProduct:()=>{}},methods:{_onTapProduct(t){this.props.onTapProduct(t)}}})},function(t,e){$global.currentComponentConfig={is:\"components/category/index\",componentLifeCycleV2:!0},Component({props:{className:\"\",type:\"horizontal\",isLoading:!1,category:{id:\"\",thumbnail_url:\"\",name:\"\"},onTapCategory:()=>{}},methods:{_onTapCategory(){const{category:t,onTapCategory:e}=this.props;e(t)}}})},function(t,e){$global.currentComponentConfig={is:\"components/category-section/index\",componentLifeCycleV2:!0,usingComponents:{category:\"components/category/index\"}},Component({props:{isLoading:!1,type:\"horizontal\",skeletons:0,className:\"\",categories:[],onTapCategory:()=>{}},methods:{_onTapCategory(t){this.props.onTapCategory(t)}}})},function(t,e){$global.currentComponentConfig={is:\"components/category-list/index\",componentLifeCycleV2:!0,usingComponents:{\"category-section\":\"components/category-section/index\"}},Component({props:{className:\"\",isLoading:!1,categories:[],onTapCategory:()=>{}},data:{isViewMoreCategories:!1},methods:{_onTapCategory(t){this.props.onTapCategory(t)},viewMoreCategories(){this.setData({isViewMoreCategories:!0})},viewLessCategories(){this.setData({isViewMoreCategories:!1})}}})},function(t,e,o){\"use strict\";o.r(e);var n=o(7);$global.currentComponentConfig={is:\"../node_modules/@tiki.vn/tini-ui/es/chip/index\",componentLifeCycleV2:\"YES\"},Component({props:{className:\"\",style:\"\",content:\"\",active:!1,suffixIcon:\"\",prefixIcon:\"\",iconRightColor:\"#1A94FF\",iconLeftColor:\"#1A94FF\",suffixImage:\"\",prefixImage:\"\",disabled:!1,onClick:function(){},onRightClick:function(){},onLeftClick:function(){}},methods:{_onClick:function(t){var e=this.props.onClick;\"function\"==typeof e&&e(Object(n.a)(this.props,t))},_onRightClick:function(t){var e=this.props.onRightClick;\"function\"==typeof e&&e(Object(n.a)(this.props,t))},_onLeftClick:function(t){var e=this.props.onLeftClick;\"function\"==typeof e&&e(Object(n.a)(this.props,t))}}})},function(t,e){$global.currentComponentConfig={is:\"../node_modules/@tiki.vn/tini-ui/es/popup/index\",componentLifeCycleV2:\"YES\"},Component({props:{className:\"\",show:!1,position:\"bottom\",mask:!0,maskClose:!0,animation:!0,disableScroll:!0},methods:{onMaskTap:function(){var t=this.props,e=t.maskClose,o=t.onClose,n=t.animation;e&&o&&(n?o():setTimeout((function(){o()}),200))}}})},function(t,e,o){\"use strict\";o.r(e);var n=o(7);$global.currentComponentConfig={is:\"../node_modules/@tiki.vn/tini-ui/es/tu-button/index\",componentLifeCycleV2:\"YES\"},Component({props:{type:\"solid\",shape:\"rounded\",size:\"large\",skeleton:!1,loading:!1,disabled:!1},methods:{onTap:function(t){var e=this.props,o=e.onTap,s=e.disabled,i=e.skeleton,a=e.loading;!o||s||i||a||o(Object(n.a)(this.props,t))}}})},function(t,e){$global.currentComponentConfig={is:\"../node_modules/@tiki.vn/tini-ui/es/bottom-sheet/index\",componentLifeCycleV2:\"YES\",usingComponents:{popup:\"../node_modules/@tiki.vn/tini-ui/es/popup/index\",\"tu-button\":\"../node_modules/@tiki.vn/tini-ui/es/tu-button/index\"}},Component({props:{mask:!0,maskClose:!0,animation:!0,show:!0,disableScroll:!1,className:\"\",popupClass:\"\",isContentScrollView:!0,distanceFromTop:50,zIndex:2,title:\"Bottom sheet\",buttonTitle:\"ok\",buttonShape:\"rounded\",buttonCls:\"\",onClose:void 0,onClick:void 0},didMount:function(){this._updateDataSet()},didUpdate:function(){this._updateDataSet()},methods:{_updateDataSet:function(){for(var t in this.dataset={},this.props)/data-/gi.test(t)&&(this.dataset[t.replace(/data-/gi,\"\")]=this.props[t])},onClose:function(){this.setData({show:!1});var t=this.props.onClose;t&&t({target:{dataset:this.dataset}})},onClick:function(){var t=this.props.onClick;t&&t({target:{dataset:this.dataset}})}}})},function(t,e){$global.currentComponentConfig={is:\"components/sort/index\",componentLifeCycleV2:!0,usingComponents:{chip:\"../node_modules/@tiki.vn/tini-ui/es/chip/index\",\"bottom-sheet\":\"../node_modules/@tiki.vn/tini-ui/es/bottom-sheet/index\"}},Component({props:{className:\"\",sorts:[],selectedSort:null,onSelect:()=>{}},data:{isShow:!1},methods:{showBottomSheet(){my.hideTabBar(),my.hideKeyboard(),this.setData({isShow:!0})},hideBottomSheet(){my.showTabBar(),this.setData({isShow:!1})},_onSelect(t){const{item:e}=t.target.dataset;this.hideBottomSheet(),this.props.onSelect(e)}}})},function(t,e){$global.currentComponentConfig={is:\"../node_modules/@tiki.vn/tini-ui/es/badge/index\",componentLifeCycleV2:\"YES\"},Component({props:{className:\"\",overflowCount:99,text:\"\",dot:!1,withArrow:!1,direction:\"middle\",stroke:!1}})},function(t,e,o){\"use strict\";o.r(e);$global.currentComponentConfig={is:\"../node_modules/@tiki.vn/tini-ui/es/tu-icon/index\",componentLifeCycleV2:\"YES\"},Component({props:{type:\"\",size:24,color:\"#27272A\",className:\"\",style:\"\"},data:{},methods:{onTap:function(t){if(this.props.onTap instanceof Function)return this.props.onTap(t)}}})},function(t,e){$global.currentComponentConfig={is:\"../node_modules/@tiki.vn/tini-ui/es/tu-label/index\",componentLifeCycleV2:\"YES\",usingComponents:{badge:\"../node_modules/@tiki.vn/tini-ui/es/badge/index\",\"tu-icon\":\"../node_modules/@tiki.vn/tini-ui/es/tu-icon/index\"}},Component({props:{showBadge:!1,icon:\"\",iconColor:\"#808089\",helperText:\"\",disabled:!1,text:\"\"}})},function(t,e,o){\"use strict\";o.r(e);var n=o(2);$global.currentComponentConfig={is:\"components/filtered-button/index\",componentLifeCycleV2:\"YES\",usingComponents:{chip:\"../node_modules/@tiki.vn/tini-ui/es/chip/index\"}},Component({props:{props:{selectedFilters:{service:null,category:null,stock_location:null,price:null,priceRange:{start:null,end:null}},onClick:()=>{}}},data:{totalFilters:0},methods:{_onClick(){this.props.onClick()},countTotalFilters(t){const e=Object.entries(t).reduce((t,[e,o])=>{if(!e||!o||\"priceRange\"===e&&!o.start||\"priceRange\"===e&&!o.end)return t;if(\"service\"===e){return t+o.filter(t=>t.checked).length}return t+1},0);this.setData({totalFilters:e})}},deriveDataFromProps(t){Object(n.d)(this.props,t)||this.countTotalFilters(t.selectedFilters)}})},function(t,e,o){\"use strict\";o.r(e);var n=o(2);$global.currentComponentConfig={is:\"components/filter/index\",componentLifeCycleV2:\"YES\",usingComponents:{\"bottom-sheet\":\"../node_modules/@tiki.vn/tini-ui/es/bottom-sheet/index\",chip:\"../node_modules/@tiki.vn/tini-ui/es/chip/index\",textfield:\"../node_modules/@tiki.vn/tini-ui/es/textfield/index\",button:\"../node_modules/@tiki.vn/tini-ui/es/tu-button/index\",\"filtered-button\":\"components/filtered-button/index\"}},Component({props:{filters:{service:[],category:[],stock_location:[],price:[]},hideCategorySection:!1,onShow:()=>{},onClose:()=>{},onSelect:()=>{}},data:{isShow:!1,disabled:!0,_selectedFilters:{service:null,category:null,stock_location:null,price:null,priceRange:{start:null,end:null}},error:\"\"},methods:{async showBottomSheet(){my.hideTabBar(),this.setData({_selectedFilters:this.props.selectedFilters}),this.setData({isShow:!0}),await Object(n.b)(200),this.setData({disabled:!1})},hideBottomSheet(){my.showTabBar(),this.setData({isShow:!1,disabled:!0})},_onSelect(){this.validatePrices()&&(this.hideBottomSheet(),this.props.onSelect(this.data._selectedFilters))},onReset(){this.setData({_selectedFilters:{service:null,category:null,stock_location:null,price:null,priceRange:{start:null,end:null}},error:\"\"})},onCheckboxChange(t){const e={...this.data},{value:o}=t.detail,{item:s}=t.target.dataset;e._selectedFilters.service||(e._selectedFilters.service=Object(n.a)(this.props.filters.service));const i=e._selectedFilters.service.findIndex(t=>t.query_name===s.query_name);e._selectedFilters.service[i].checked=o,this.setData(e)},onSelectSingleSection(t){const{item:e,query_name:o}=t.target.dataset,n={...this.data};n._selectedFilters[o]&&n._selectedFilters[o].query_value===e.query_value?n._selectedFilters[o]=null:n._selectedFilters[o]=e,\"price\"===o&&(n._selectedFilters.priceRange={start:null,end:null},n.error=\"\"),this.setData(n)},onInputPrice(t){const{position:e}=t.target.dataset,o={...this.data},s=Object(n.f)(t.detail.value);o._selectedFilters.price=null,o._selectedFilters.priceRange||(o._selectedFilters.priceRange={}),o._selectedFilters.priceRange[e]=s?{value:s,display:Object(n.e)(s,\"\")}:null,this.setData(o),this.checkCorrectPrices()},validatePrices(){const{priceRange:t}=this.data._selectedFilters;return!t.end&&!t.start||(t.end&&!t.start||!t.end&&t.start?(this.setData({error:\"Vui lòng điền đẩy đủ giá bắt đầu và giá kết thúc\"}),!1):t.end.value<=t.start.value?(this.setData({error:\"Giá kết thúc phải lớn hơn giá bắt đầu\"}),!1):(this.setData({error:\"\"}),!0))},checkCorrectPrices(){const{priceRange:t}=this.data._selectedFilters;(!t.end&&!t.start||t.end.value>t.start.value)&&this.setData({error:\"\"})}},deriveDataFromProps(t){Object(n.d)(this.props,t)||this.setData({_selectedFilters:t.selectedFilters})}})},function(t,e,o){\"use strict\";o.r(e);var n=o(2);$global.currentComponentConfig={is:\"components/filtered-list/index\",componentLifeCycleV2:\"YES\",usingComponents:{chip:\"../node_modules/@tiki.vn/tini-ui/es/chip/index\"}},Component({props:{className:\"\",selectedFilters:{service:null,category:null,stock_location:null,price:null,priceRange:{start:null,end:null}},onRemoveFilter:()=>{}},data:{formattedSelectedFilters:[]},methods:{_onRemoveFilter(t){const{item:e}=t.target.dataset;this.props.onRemoveFilter(e)},formatFilteredItems(t){const e=Object.entries(t).reduce((t,[e,o])=>{if(!e||!o)return t;if(\"service\"===e){const e=o.filter(t=>t.checked).map(t=>({key:t.query_name,value:t.display_value}));if(e.length)return[...t,...e]}const n=((t,e)=>{switch(t){case\"priceRange\":return e.start&&e.end?`Từ ${e.start.display||0} đến ${e.end.display||0}`:\"\";default:return e.display_value}})(e,o);return n?[...t,{key:e,value:n}]:t},[]);this.setData({formattedSelectedFilters:e})}},deriveDataFromProps(t){Object(n.d)(this.props,t)||this.formatFilteredItems(t.selectedFilters)}})},function(t,e){$global.currentComponentConfig={is:\"components/empty/index\",componentLifeCycleV2:!0,usingComponents:{button:\"../node_modules/@tiki.vn/tini-ui/es/tu-button/index\"}},Component({props:{title:\"\",description:\"\",buttonText:\"\",className:\"\",showBottomDivider:!1,onTapButton:()=>{}},methods:{_onTapButton(){this.props.onTapButton()}}})},function(t,e,o){\"use strict\";o.r(e);var n=o(0),s=o(1),i=o(5),a=o(3),r=o(4),c=o(2);$global.currentPageConfig={pagePath:\"pages/product/index\",usingComponents:{\"product-section\":\"components/product-section/index\",sort:\"components/sort/index\",filter:\"components/filter/index\",\"category-list\":\"components/category-list/index\",\"filtered-list\":\"components/filtered-list/index\",empty:\"components/empty/index\"}},Page({hasMore:!1,actionButtons:0,data:{showActions:!1,showCategory:!1,isLoadingCategories:!1,isLoadingProduct:!0,isLoadingMoreProduct:!1,products:{data:[],paging:{current_page:0,last_page:0}},popularProducts:{data:[]},sorts:a.c,selectedSort:a.c[0],selectedCategory:null,filters:r.a,selectedFilters:{service:null,category:null,stock_location:null,price:null,priceRange:{start:null,end:null}},isStickButtons:!1,isScrollUp:!1},async loadData(){this.setData({isLoadingProduct:!0,isLoadingCategories:!0});try{const[t,e]=await Promise.all([Object(s.c)({page:1,limit:10,category:this.data.selectedCategory,sort:this.data.selectedSort.value}),Object(s.c)({page:1,limit:4,sort:\"default\"})]);this.hasMore=t.paging.current_page<t.paging.last_page,this.setData({products:t,popularProducts:e,categories:Object(c.c)(t.filters[0].values,4),isLoadingProduct:!1,isLoadingCategories:!1})}catch{this.setData({isLoadingProduct:!1,isLoadingCategories:!1})}},async loadProducts(){this.setData({isLoadingProduct:!0});try{const t=await Object(s.c)({page:1,limit:10,sort:this.data.selectedSort.value,category:this.data.selectedCategory,filter:Object(r.b)(this.data.selectedFilters)});this.hasMore=t.paging.current_page<t.paging.last_page,this.setData({products:t,isLoadingProduct:!1})}catch{this.setData({isLoadingProduct:!1})}},async loadMoreProducts(){const{products:t,isLoadingProduct:e,isLoadingMoreProduct:o}=this.data;if(!this.hasMore||e||o)return;this.setData({isLoadingMoreProduct:!0});const{data:n,paging:i}=t;try{const{data:t,paging:e}=await Object(s.c)({page:i.current_page+1,limit:10,sort:this.data.selectedSort.value,category:this.data.selectedCategory,filter:Object(r.b)(this.data.selectedFilters)});this.hasMore=e.current_page<e.last_page,this.setData({products:{data:[...n,...t],paging:e},isLoadingMoreProduct:!1})}catch{this.setData({isLoadingMoreProduct:!1})}},onSelectFilter(t){this.setData({selectedFilters:t}),this.loadProducts()},onSelectSort(t){this.setData({selectedSort:t}),this.loadProducts()},removeFilter(t){const e={...this.data};if(\"priceRange\"===t.key)return e.selectedFilters[t.key]={start:null,end:null},this.setData(e),void this.loadProducts();const o=e.selectedFilters.service&&e.selectedFilters.service.findIndex(e=>e.query_name===t.key);if(\"number\"==typeof o&&-1!==o)return e.selectedFilters.service[o].checked=!1,this.setData(e),void this.loadProducts();e.selectedFilters[t.key]=null,this.setData(e),this.loadProducts()},onTapProduct(t){Object(n.b)({product:t,page:\"product\"})},goToCategoryDetail(t){Object(n.c)({page:\"product\",params:{title:t.display_value,category:t.query_value,showCategory:!1}})},onCustomIconEvent(){Object(n.d)(\"tikivn://cart\")},onLoad(t){const{title:e,sort:o,category:s,showCategory:i=!0,showActions:r=!0}=Object(n.e)(t),c={...this.data};if(o){const t=a.c.find(t=>t.value===o);t&&(c.selectedSort=t)}s&&(c.selectedCategory=s),this.setData({...c,showCategory:i,showActions:r}),my.setNavigationBar({title:\"Sản phẩm\"}),Object(n.f)()},onPageScroll(t){const{isStickButtons:e,isScrollUp:o}=this.data,{scrollHeight:n,scrollTop:s}=t;s>=this.actionButtons+40&&!e&&this.setData({isStickButtons:!0}),s<this.actionButtons+40&&e&&this.setData({isStickButtons:!1}),s<this.prevScrollTop&&!o&&this.setData({isScrollUp:!0}),s>this.prevScrollTop&&o&&this.setData({isScrollUp:!1}),this.prevScrollTop=s,i.b.windowHeight+s>=n-1e3&&this.loadMoreProducts()},onReady(){this.loadData(),this.setData({filters:r.a}),my.createSelectorQuery().select(\".product-action-buttons\").boundingClientRect().exec(([t])=>{this.actionButtons=t&&t.top?t.top:0})}})},function(t,e,o){\"use strict\";o.r(e);var n=o(8),s=o.n(n);function i(t){return t.reduce((function(t,e){var o;return s()({},t,((o={})[e]=function(t){if(this.props[e]instanceof Function)return this.props[e](t)},o))}),{})}$global.currentComponentConfig={is:\"../node_modules/@tiki.vn/tini-ui/es/search-bar/index\",componentLifeCycleV2:\"YES\",usingComponents:{textfield:\"../node_modules/@tiki.vn/tini-ui/es/textfield/index\"}},Component({props:{className:\"\",style:\"\",shape:\"\",placeholder:\"\",value:\"\",controlled:!1,hasError:!1,errorIconColor:\"#ff424f\"},data:{__value:\"\"},didMount:function(){this.onChangeValue(this.props.value)},deriveDataFromProps:function(t){this.onChangeValue(t.value)},methods:s()({},i([\"onFocus\",\"onBlur\",\"onConfirm\",\"onInput\",\"onTapSearchIcon\"]),{onChangeValue:function(t){this.data.__value!==t&&this.setData({__value:t})},onTapCloseIcon:function(t){try{this.setData({__value:\"\"});var e=i([\"onTapCloseIcon\"]).onTapCloseIcon.bind(this);e(t)}catch(t){console.error(t)}}})})},function(t,e,o){\"use strict\";o.r(e);var n=o(12),s=o.n(n);$global.currentComponentConfig={is:\"components/search-bar/index\",componentLifeCycleV2:!0,usingComponents:{\"search-bar\":\"../node_modules/@tiki.vn/tini-ui/es/search-bar/index\"}},Component({props:{className:\"\",placeholder:\"Tìm kiếm sản phẩm\",value:\"\",onInput:()=>{},onSearch:()=>{},onConfirm:()=>{},onClear:()=>{}},methods:{isTyping:null,_onChangeSearchInput:s()((function(t){this.props.onInput(t.detail.value)}),500),_clearSearchInput(){this.props.onInput(\"\"),this.props.onClear(this.props.value)},_onSearch(){this.props.onSearch(this.props.value)},_onConfirm(t){this.props.onConfirm(t.detail.value)}},didUpdate(){this.isTyping&&clearTimeout(this.isTyping),this.isTyping=setTimeout(()=>{this._onSearch()},400)}})},function(t,e,o){var n=o(10);t.exports=function(){return n.Date.now()}},function(t,e){t.exports=!1},function(t,e,o){var n=o(54),s=o(9),i=o(56),a=/^[-+]0x[0-9a-f]+$/i,r=/^0b[01]+$/i,c=/^0o[0-7]+$/i,l=parseInt;t.exports=function(t){if(\"number\"==typeof t)return t;if(i(t))return NaN;if(s(t)){var e=\"function\"==typeof t.valueOf?t.valueOf():t;t=s(e)?e+\"\":e}if(\"string\"!=typeof t)return 0===t?t:+t;t=n(t);var o=r.test(t);return o||c.test(t)?l(t.slice(2),o?2:8):a.test(t)?NaN:+t}},function(t,e,o){var n=o(55),s=/^\\s+/;t.exports=function(t){return t?t.slice(0,n(t)+1).replace(s,\"\"):t}},function(t,e){var o=/\\s/;t.exports=function(t){for(var e=t.length;e--&&o.test(t.charAt(e)););return e}},function(t,e,o){var n=o(57),s=o(60);t.exports=function(t){return\"symbol\"==typeof t||s(t)&&\"[object Symbol]\"==n(t)}},function(t,e,o){var n=o(11),s=o(58),i=o(59),a=n?n.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?\"[object Undefined]\":\"[object Null]\":a&&a in Object(t)?s(t):i(t)}},function(t,e,o){var n=o(11),s=Object.prototype,i=s.hasOwnProperty,a=s.toString,r=n?n.toStringTag:void 0;t.exports=function(t){var e=i.call(t,r),o=t[r];try{t[r]=void 0;var n=!0}catch(t){}var s=a.call(t);return n&&(e?t[r]=o:delete t[r]),s}},function(t,e){var o=Object.prototype.toString;t.exports=function(t){return o.call(t)}},function(t,e){t.exports=function(t){return null!=t&&\"object\"==typeof t}},function(t,e){$global.currentComponentConfig={is:\"components/coupon-n-point/index\",componentLifeCycleV2:!0},Component({props:{user:{coupons:0,points:0}},methods:{onMoveMyCoupon(){my.navigateTo({url:\"pages/my-coupon/index\"})},onMoveMyPoint(){my.navigateTo({url:\"pages/my-point/index\"})}},didMount(){}})},function(t,e){$global.currentComponentConfig={is:\"components/my-orders/order-icon/index\",componentLifeCycleV2:!0},Component({props:{isLoading:!0,tab:0,src:\"\",text:\"\",value:\"\",onTap:()=>{}},methods:{_onTap(){this.props.onTap(this.props.tab)}}})},function(t,e){$global.currentComponentConfig={is:\"components/my-orders/index\",componentLifeCycleV2:!0,usingComponents:{\"order-icon\":\"components/my-orders/order-icon/index\"}},Component({props:{isLoading:!0,orderIcons:[{key:\"waiting\",value:\"Harry Potter\",src:\"/assets/icons/book1.svg\"},{key:\"processing\",value:\"Matering Bitcoin\",src:\"/assets/icons/book2.svg\"},{key:\"shipping\",value:\"Normal People\",src:\"/assets/icons/book3.svg\"}],numOrders:{waiting:0,processing:0,shipping:0}},methods:{onMoveOrderManagement(t){my.navigateTo({url:\"pages/home/index\"})}},didMount(){}})},function(t,e,o){\"use strict\";o.r(e);var n=o(1);$global.currentPageConfig={pagePath:\"pages/profile/index\",usingComponents:{\"coupon-n-point\":\"components/coupon-n-point/index\",\"my-orders\":\"components/my-orders/index\"}},Page({data:{isLoading:!1,user:{},numOrders:{}},async loadData(){this.setData({isLoading:!0});try{const[t,e]=await Promise.all([Object(n.d)(),Object(n.a)()]);this.setData({user:t,numOrders:e,isLoading:!1})}catch(t){this.setData({isLoading:!1})}},onReady(){this.loadData()}})},function(t,e,o){\"use strict\";o.r(e);var n=o(1);var s=class{constructor(){this.disposables=[]}push(...t){return t.push(...t)}dispose(){this.disposables.forEach(t=>t())}},i=o(4),a=o(0),r=o(2);$global.currentPageConfig={pagePath:\"pages/home/index\",usingComponents:{banners:\"components/banners/index\",\"section-title\":\"components/section-title/index\",\"product-section\":\"components/product-section/index\",\"category-list\":\"components/category-list/index\"}};const c=getApp();Page({disposable:new s,data:{scrolledHeader:!1,isLoading:!0,bestSellerProducts:{data:[]},popularProducts:{data:[]},newestProducts:{data:[]},categories:[],brandLogo:\"\",brandCover:\"\"},async loadData(){this.setData({isLoading:!0});try{const[t,e,o]=await Promise.all([Object(n.c)({page:1,limit:3,sort:\"top_seller\"}),Object(n.c)({page:1,limit:4,sort:\"default\"}),Object(n.c)({page:1,limit:4,sort:\"newest\"})]);Object(i.c)(t.filters),this.setData({bestSellerProducts:t,popularProducts:e,newestProducts:o,categories:Object(r.c)(t.filters[0].values,4),isLoading:!1})}catch{this.setData({isLoading:!1})}},goToProductPage(t){Object(a.c)({page:\"product\",params:{...t,showActions:!1}})},goToCategoryDetail(t){Object(a.c)({page:\"product\",params:{title:t.display_value,category:t.query_value,showCategory:!1}})},onTapProduct(t){Object(a.b)({product:t,page:\"home\"})},onCustomIconEvent(){Object(a.d)(\"tikivn://cart\")},onLoad(){Object(a.f)()},async onPullDownRefresh(){await this.loadData(),my.stopPullDownRefresh()},onPageScroll(t){this.data.scrolledHeader&&t.scrollTop<=30&&this.setData({scrolledHeader:!1}),!this.data.scrolledHeader&&t.scrollTop>30&&this.setData({scrolledHeader:!0})},onReady(){this.loadData(),this.setData({brandLogo:c.brandLogo,brandCover:c.brandCover})},onUnload(){this.disposable.dispose()}})},function(t,e,o){\"use strict\";o.r(e);var n={}.hasOwnProperty;var s=o(7);$global.currentComponentConfig={is:\"../node_modules/@tiki.vn/tini-ui/es/textfield/index\",componentLifeCycleV2:\"YES\",usingComponents:{\"tu-label\":\"../node_modules/@tiki.vn/tini-ui/es/tu-label/index\",\"tu-icon\":\"../node_modules/@tiki.vn/tini-ui/es/tu-icon/index\"}},Component({data:{paddingHorizontal:16,iconDisabledColor:\"rgba(166, 166, 176, 0.6)\",wrapClass:\"\"},props:{labelCls:\"\",showBadge:!1,labelIcon:\"\",labelIconColor:\"#808089\",helperText:\"\",labelText:\"\",iconRight:\"\",iconLeft:\"\",iconColor:\"#808089\",shape:\"rounded\",loading:!1,inputCls:\"\",className:\"\",errorMsg:\"\",readonly:!1,hasError:!1,errorIconColor:\"#ff424f\",type:\"text\",password:!1,name:\"\",value:\"\",placeholder:\"\",placeholderClass:\"\",placeholderStyle:\"\",disabled:!1,maxlength:140,focus:!1,controlled:!1,onTap:void 0,onTapRightIcon:void 0,onTapLeftIcon:void 0,onInput:void 0,onConfirm:void 0,onFocus:void 0,onBlur:void 0},onInit:function(){this.setData({wrapClass:this.getWrapClass(this.props)})},didUpdate:function(t){this.isClassChange(t,this.props)&&this.setData({wrapClass:this.getWrapClass(this.props)})},methods:{getWrapClass:function(t){var e,o=t.shape,s=t.hasError;return function t(){for(var e=[],o=0;o<arguments.length;o++){var s=o<0||arguments.length<=o?void 0:arguments[o];if(s){var i=typeof s;if(\"string\"===i||\"number\"===i)e.push(s);else if(Array.isArray(s)&&s.length){var a=t.apply(null,s);a&&e.push(a)}else if(\"object\"===i)for(var r in s)n.call(s,r)&&s[r]&&e.push(r)}}return e.join(\" \")}(((e={}).error=s,e.rounded=\"rounded\"===o,e.pill=\"pill\"===o,e))},isClassChange:function(t,e){return t.shape!==e.shape||t.hasError!==e.hasError},onEvent:function(t,e){var o=this.props[t];o&&e&&o(Object(s.a)(this.props,e))},onTap:function(t){this.onEvent(\"onTap\",t)},onTapIconLeft:function(t){this.onEvent(\"onTapIconLeft\",t)},onTapIconRight:function(t){this.onEvent(\"onTapIconRight\",t)},onBlur:function(t){this.onEvent(\"onBlur\",t)},onConfirm:function(t){this.onEvent(\"onConfirm\",t)},onFocus:function(t){this.onEvent(\"onFocus\",t)},onInput:function(t){this.onEvent(\"onInput\",t)}}})},function(t,e,o){\"use strict\";o.r(e);var n=o(0),s=o(1),i=o(5),a=o(3),r=o(4);const c=t=>new Promise((e,o)=>{my.getStorage({key:t,success:t=>e(t.data),fail:t=>o(t)})}),l=(t,e)=>new Promise((o,n)=>{my.setStorage({key:t,data:e,success:t=>{o(t)},fail:t=>{n(t)}})});var u=o(2);$global.currentPageConfig={pagePath:\"pages/search/index\",usingComponents:{\"product-section\":\"components/product-section/index\",sort:\"components/sort/index\",filter:\"components/filter/index\",\"category-list\":\"components/category-list/index\",\"filtered-list\":\"components/filtered-list/index\",empty:\"components/empty/index\",\"search-bar\":\"components/search-bar/index\"}},Page({hasMore:!1,actionButtons:0,maxSearch:5,isSaveRecentKeyAfterScroll:!1,data:{searchTerm:\"\",recentKeys:[],isLoadingCategories:!1,isLoadingProduct:!0,isLoadingMoreProduct:!1,products:{data:[],paging:{current_page:0,last_page:0}},popularProducts:{data:[]},sorts:a.c,selectedSort:a.c[0],selectedCategory:null,filters:r.a,selectedFilters:{service:null,category:null,stock_location:null,price:null,priceRange:{start:null,end:null}}},async loadData(){this.setData({isLoadingProduct:!0,isLoadingCategories:!0});try{const[t,e,o]=await Promise.all([Object(s.c)({page:1,limit:10,category:this.data.selectedCategory,sort:this.data.selectedSort.value}),Object(s.c)({page:1,limit:4,sort:\"default\"}),c(\"recent-search\")]);this.hasMore=t.paging.current_page<t.paging.last_page,this.setData({products:t,popularProducts:e,categories:Object(u.c)(t.filters[0].values,4),isLoadingProduct:!1,isLoadingCategories:!1,recentKeys:o?o.slice(0,this.maxSearch):[]})}catch{this.setData({isLoadingProduct:!1,isLoadingCategories:!1})}},async loadProducts(){this.setData({isLoadingProduct:!0});try{const t=await Object(s.c)({page:1,limit:10,sort:this.data.selectedSort.value,category:this.data.selectedCategory,filter:Object(r.b)(this.data.selectedFilters),q:this.data.searchTerm});this.hasMore=t.paging.current_page<t.paging.last_page,this.setData({products:t,isLoadingProduct:!1})}catch{this.setData({isLoadingProduct:!1})}},async loadMoreProducts(){const{products:t,isLoadingProduct:e,isLoadingMoreProduct:o}=this.data;if(!this.hasMore||e||o)return;this.setData({isLoadingMoreProduct:!0});const{data:n,paging:i}=t;try{const{data:t,paging:e}=await Object(s.c)({page:i.current_page+1,limit:10,sort:this.data.selectedSort.value,category:this.data.selectedCategory,filter:Object(r.b)(this.data.selectedFilters),q:this.data.searchTerm});this.hasMore=e.current_page<e.last_page,this.setData({products:{data:[...n,...t],paging:e},isLoadingMoreProduct:!1})}catch{this.setData({isLoadingMoreProduct:!1})}},onSelectFilter(t){this.setData({selectedFilters:t}),this.loadProducts()},onSelectSort(t){this.setData({selectedSort:t}),this.loadProducts()},removeFilter(t){const e={...this.data};if(\"priceRange\"===t.key)return e.selectedFilters[t.key]={start:null,end:null},this.setData(e),void this.loadProducts();const o=e.selectedFilters.service&&e.selectedFilters.service.findIndex(e=>e.query_name===t.key);if(\"number\"==typeof o&&-1!==o)return e.selectedFilters.service[o].checked=!1,this.setData(e),void this.loadProducts();e.selectedFilters[t.key]=null,this.setData(e),this.loadProducts()},onTapProduct(t){this.addNewRecentKey(this.data.searchTerm),Object(n.b)({product:t,page:\"product\"})},goToCategoryDetail(t){Object(n.c)({page:\"product\",params:{title:t.display_value,category:t.query_value,showCategory:!1}})},async onInput(t){this.isSaveRecentKeyAfterScroll=!1;const e=await c(\"recent-search\"),o=\"\"===t?{recentKeys:e,isLoadingProduct:!1}:{isLoadingProduct:!0};this.setData({searchTerm:t,...o})},async onSearch(t){t&&this.loadProducts()},onConfirm(t){this.onSearch(t),this.addNewRecentKey(t)},onClear(t){this.addNewRecentKey(t)},async removeKeySearch(t){const{item:e}=t.target.dataset,o=(await c(\"recent-search\")).filter(t=>t!==e);l(\"recent-search\",o),this.setData({recentKeys:o})},clearAllRecentKeys(){l(\"recent-search\",[]),this.setData({recentKeys:[]})},onClickKeySearch(t){const{key:e}=t.target.dataset;this.setData({searchTerm:e,isLoadingProduct:!0}),this.addNewRecentKey(e)},async addNewRecentKey(t){if(!t||0===t.length)return;const e=await c(\"recent-search\");let o=e?e.slice(0,this.maxSearch):[];o.includes(t)&&(o=o.filter(e=>e!==t));const n=[t,...o.slice(0,this.maxSearch-1)];l(\"recent-search\",n),this.setData({recentKeys:n})},onCustomIconEvent(){Object(n.d)(\"tikivn://cart\")},onLoad(){Object(n.f)()},onPageScroll(t){const{scrollHeight:e,scrollTop:o}=t;i.b.windowHeight+o>=e-1e3&&this.loadMoreProducts()},onReady(){this.loadData(),this.setData({filters:r.a})}})}]);","extractedComments":[]}